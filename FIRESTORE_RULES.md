# Firestore å®‰å…¨è§„åˆ™é…ç½®

## ğŸ”§ ä¿®å¤æƒé™é”™è¯¯

å¦‚æœçœ‹åˆ° `Missing or insufficient permissions` é”™è¯¯ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ›´æ–° Firestore å®‰å…¨è§„åˆ™ã€‚

## ğŸ“ æ­¥éª¤ 1: æ‰“å¼€ Firestore è§„åˆ™ç¼–è¾‘å™¨

1. è®¿é—® [Firebase Console](https://console.firebase.google.com/)
2. é€‰æ‹©æ‚¨çš„é¡¹ç›® `xiangqiai-ce5d2`
3. åœ¨å·¦ä¾§èœå•ç‚¹å‡»ã€ŒFirestore Databaseã€
4. ç‚¹å‡»ã€Œè§„åˆ™ã€æ ‡ç­¾

## ğŸ“ æ­¥éª¤ 2: å¤åˆ¶å¹¶ç²˜è´´ä»¥ä¸‹è§„åˆ™

å°†ä»¥ä¸‹è§„åˆ™**å®Œå…¨æ›¿æ¢**ç°æœ‰çš„è§„åˆ™ï¼š

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // å…è®¸è®¿é—®æ‰€æœ‰æ–‡æ¡£ï¼ˆå¼€å‘æ¨¡å¼ï¼‰
    match /{document=**} {
      allow read, write: if true;
    }
  }
}
```

## ğŸ“ æ­¥éª¤ 3: å‘å¸ƒè§„åˆ™

1. ç‚¹å‡»ã€Œå‘å¸ƒã€æŒ‰é’®
2. ç­‰å¾…è§„åˆ™å‘å¸ƒå®Œæˆï¼ˆé€šå¸¸å‡ ç§’é’Ÿï¼‰
3. åº”è¯¥çœ‹åˆ°ã€Œè§„åˆ™å·²å‘å¸ƒã€çš„ç¡®è®¤æ¶ˆæ¯

## âœ… éªŒè¯

1. åˆ·æ–°æ‚¨çš„åº”ç”¨é¡µé¢
2. æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰
3. åº”è¯¥ä¸å†çœ‹åˆ°æƒé™é”™è¯¯
4. åº”è¯¥çœ‹åˆ° `[Firebase] System prompt saved` æˆ–ç±»ä¼¼çš„æˆåŠŸæ¶ˆæ¯

## ğŸ”’ ç”Ÿäº§ç¯å¢ƒè§„åˆ™ï¼ˆå¯é€‰ï¼‰

å¦‚æœæ‚¨æƒ³ä¸ºç”Ÿäº§ç¯å¢ƒé…ç½®æ›´å®‰å…¨çš„è§„åˆ™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹è§„åˆ™ï¼š

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // å…è®¸ç”¨æˆ·åœ¨è®¤è¯åè®¿é—® "cities" é›†åˆä¸­çš„æ–‡æ¡£
    match /cities/{city} {
      allow read, write: if request.auth != null;
    }

    // åœå¦ç»“æœé›†åˆ - å…è®¸æ‰€æœ‰äººè¯»å–ï¼Œä½†åªæœ‰è®¤è¯ç”¨æˆ·å¯å†™å…¥
    match /divination_results/{document} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // ç³»ç»Ÿè®¾ç½®é›†åˆ - å…è®¸æ‰€æœ‰äººè¯»å–ï¼Œä½†åªæœ‰è®¤è¯ç”¨æˆ·å¯å†™å…¥
    match /system_settings/{document} {
      allow read: if true;
      allow write: if request.auth != null;
    }
    
    // å…¶ä»–æ‰€æœ‰æ–‡æ¡£ - é»˜è®¤æ‹’ç»
    match /{document=**} {
      allow read, write: if false;
    }
  }
}
```

**æ³¨æ„**ï¼šç”Ÿäº§ç¯å¢ƒè§„åˆ™éœ€è¦å¯ç”¨ Firebase Authenticationã€‚å¼€å‘é˜¶æ®µå»ºè®®ä½¿ç”¨æµ‹è¯•æ¨¡å¼è§„åˆ™ã€‚

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜ 1: è§„åˆ™å‘å¸ƒåä»ç„¶æŠ¥é”™
**è§£å†³æ–¹æ³•**ï¼š
- ç­‰å¾… 1-2 åˆ†é’Ÿè®©è§„åˆ™ç”Ÿæ•ˆ
- åˆ·æ–°æµè§ˆå™¨é¡µé¢
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜

### é—®é¢˜ 2: è§„åˆ™ç¼–è¾‘å™¨æ˜¾ç¤ºè¯­æ³•é”™è¯¯
**è§£å†³æ–¹æ³•**ï¼š
- æ£€æŸ¥æ˜¯å¦å®Œå…¨å¤åˆ¶äº†è§„åˆ™ä»£ç 
- ç¡®ä¿æ²¡æœ‰é¢å¤–çš„ç©ºæ ¼æˆ–å­—ç¬¦
- æ£€æŸ¥ JavaScript è¯­æ³•æ˜¯å¦æ­£ç¡®

### é—®é¢˜ 3: ä»ç„¶æ— æ³•è®¿é—®
**è§£å†³æ–¹æ³•**ï¼š
- ç¡®è®¤è§„åˆ™å·²æˆåŠŸå‘å¸ƒ
- æ£€æŸ¥ Firebase é¡¹ç›®æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç¯å¢ƒå˜é‡ä¸­çš„é¡¹ç›® ID æ˜¯å¦æ­£ç¡®





